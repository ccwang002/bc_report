{% extends 'base/base.html' %}

{% block title %}FastQC{% endblock title %}

{% block extra_css %}
	<style>
		.chart {
			height: 600px;
		}
		#chart-qc-perbase {
		}
	</style>
{% endblock extra_css %}

{% block content %}
	<h2>QC Info</h2>
	<div class="table-responsive">
	<table class="table table-striped table-responsive">
		<thead>
			<tr>
				<th>Source</th>
				{% for module in MODULES %}
					<th>{{ module }}</th>
				{% endfor %}
			</tr>
		</thead>
		<tbody>
			{% for source, qc_info in data_info.qc_info.items() %}
			<tr>
				<th><a href="{{ data_info.raw_fastqc[source] }}">{{ source }}</a></th>
				{% for module in MODULES %}
					<td>
						{% if module in qc_info %}
							<i class="fa {{ STATUS_TO_ICON_CLASS[qc_info[module]] }}"></i>
						{% else %}
							NA
						{% endif %}
						<span class="sr-only">{{ qc_info.get(module, 'NA') }}</span>
					</td>
				{% endfor %}
			</tr>
			{% endfor %}
		</tbody>
	</table>
	</div>
	<h2>Per Base Quality Plot</h2>
	<div id="chart-qc-perbase" class="chart"></div>
{% endblock content %}

{% block extra_js %}
	<script src="{{ static('js/vendors/highcharts/highcharts.js') }}" type="text/javascript" charset="utf-8"></script>
	<script src="{{ static('js/vendors/highcharts/canvas-tools.js') }}" type="text/javascript" charset="utf-8"></script>
	<script src="{{ static('js/vendors/highcharts/exporting.js') }}" type="text/javascript" charset="utf-8"></script>
	<script src="{{ static('js/vendors/highcharts/highcharts-export-clientside.js') }}" type="text/javascript" charset="utf-8"></script>
{% endblock extra_js %}

{% block scripts %}
	<script type="text/javascript">
		$(function() {
			$article = $('article');
			$sidebar = $('.sidebar');
			$btnNavShow = $('.btn-nav-show');
			$('.btn-nav-collapse').click(function() {
				$article.removeClass('col-sm-10 col-sm-offset-2');
				$sidebar.hide();
				$btnNavShow.show();
				$('.chart').highcharts().reflow();
			});
			$btnNavShow.click(function() {
				$article.addClass('col-sm-10 col-sm-offset-2');
				$sidebar.show();
				$btnNavShow.hide();
				$('.chart').highcharts().reflow();
			});
		});
		var qc_perbase_data = {{ data_info.per_base_quality|tojson|safe }};
	</script>
	<script src="{{ static('js/fastqc/fastqc.js') }}" type="text/javascript" charset="utf-8"></script>
{% endblock scripts %}
