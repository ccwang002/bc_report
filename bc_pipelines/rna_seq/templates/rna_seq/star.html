{% extends 'rna_seq/base.html' %}

{% block title %}STAR{% endblock title %}

{% block nav %}
	{% set active = "star" %}
	{% include "rna_seq/_includes/nav.html" %}
{% endblock nav %}

{% block content %}
	<h2>STAR Alignment</h2>

	<h2>Original output files</h2>
	{% for condition, samples in analysis_info.conditions.items() %}
		<h3>Condition: {{ condition }}</h3>
		<table class="table table-striped">
			<thead>
			<tr>
				<th>Sample</th>
				<th>Sorted alignment result (BAM)</th>
				<th>Splice Junctions (TSV)</th>
				<th>Log files</th>
			</tr>
			</thead>
			<tbody>
			{% for sample in samples %}
				{% set file_links = data_info.raw_output[sample] %}
				<tr>
					<td>{{ sample }}</td>
					<!-- Alignment -->
					<td>
						<a href="{{ file_links['Aligned.sortedByCoord.out.bam'] }}">
							<i class="fa fa-file-o" aria-hidden="true"></i>
							<code>Aligned.sortedByCoord.out.bam</code>
						</a><br>
						<a href="{{ file_links['Aligned.sortedByCoord.out.bam.bai'] }}">
							<i class="fa fa-file-o" aria-hidden="true"></i>
							<code>Aligned.sortedByCoord.out.bam.bai</code>
						</a>
					</td>
					<!-- Splice Junctions -->
					<td>
						<a href="{{ file_links['SJ.out.tab'] }}">
							<i class="fa fa-file-o" aria-hidden="true"></i>
							<code>SJ.out.tab</code>
						</a>
					</td>
					<!-- Log files -->
					<td>
						{% for f in ['Log.out', 'Log.final.out', 'Log.progress.out'] %}
							<a href="{{ file_links[f] }}">
								<i class="fa fa-file-o" aria-hidden="true"></i>
								<code>{{ f }}</code>
							</a>{% if not loop.last %}<br>{% endif %}
						{% endfor %}
					</td>
				</tr>
			{% endfor %}
			</tbody>
		</table>
	{% endfor %}
{% endblock content %}
